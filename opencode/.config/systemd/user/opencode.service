[Unit]
Description=OpenCode Server
Documentation=https://opencode.ai/docs
After=network-online.target
Wants=network-online.target
StartLimitIntervalSec=300
StartLimitBurst=5

[Service]
Type=exec
WorkingDirectory=%h
ExecStart=%h/.opencode/bin/opencode serve --hostname 0.0.0.0 --port 4096
Restart=on-failure
RestartSec=10

# Security hardening
NoNewPrivileges=true
ProtectSystem=strict
ProtectHome=read-only
ReadWritePaths=%h
PrivateTmp=true

# Resource limits
MemoryMax=4G
TasksMax=256

[Install]
WantedBy=default.target
